a += (c_ptr[i] == 0) * (p1[i]+p2[i])*(p1[i]-p2[i]) + (c_ptr[i] != 0) * (p1[i]+p2[i])*(p1[i]+p2[i]);